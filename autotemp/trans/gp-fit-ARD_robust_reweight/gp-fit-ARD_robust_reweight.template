@limits <lower=1>
int N : 101
@limits <lower=1>
int D : 2
vector [D] x[N] : [[2,1.24],[-0.04,1],[0.56,-1.4],[0.4,-1.52],[-0.36,1.92],[-1.92,-0.24],[1.36,-0.16],[0.76,-1.36],[-1.88,0.36],[-0.72,-0.92],[-1.16,-1.08],[0.96,0.76],[0.12,-0.88],[1,1.24],[-0.12,-1.64],[1.64,1.28],[-1.6,-0.28],[-1.16,1.04],[1.16,0.64],[1.28,-0.24],[-1.16,0.52],[-1.84,-2],[1.6,-1.16],[-1.88,0.84],[0.72,-1.16],[-2,1.28],[-2,-0.76],[-0.88,0.76],[1.8,1.72],[0.64,-1.56],[1.44,-1.52],[-0.84,0.72],[-1.28,-0.28],[-2,1.36],[1.16,1.88],[-1.64,-1.72],[-0.92,-0.16],[0.4,0.8],[1,-1.68],[1.64,1.96],[-0.16,-1],[1.96,-1.84],[-1.88,0.76],[-1.44,1.16],[0.24,-0.6],[1.4,-0.56],[1.48,-0.88],[-1.84,-1.68],[0.96,-0.56],[1.6,-1.32],[1.52,0.12],[0.6,0],[1.88,1.76],[-0.84,-0.64],[0.76,-0.16],[-0.84,-1.68],[-0.44,1.44],[0.96,-0.44],[1.64,0.92],[-1.04,-1.32],[0.64,-0.2],[-0.72,1.08],[-0.84,-1.76],[1.28,1.24],[-1.12,-0.8],[0.4,-0.56],[-0.72,-0.76],[1,-1.88],[-1.8,0.08],[-1.56,0.72],[0.4,1.6],[0.24,-1.92],[-1.24,1.96],[-0.52,-0.8],[-1.36,1.76],[1.76,0.72],[1.24,2],[1.4,1.24],[1.84,-1.88],[-1.76,0.96],[1.8,-0.64],[-1.64,1.32],[0.64,0.12],[0,-0.92],[-1.08,1.2],[-1.28,-1.64],[-0.68,1.32],[0.92,-0.92],[-0.36,1],[0.12,1.84],[-1.4,-1.68],[0.08,1.4],[-0.84,1.2],[0.2,-0.48],[1.16,-0.72],[0.04,-1.2],[1.88,0.24],[1.36,1.52],[1.96,0.08],[0.84,0.32],[0.32,0.64]]
vector [N] y : [2.16333085530428, 0.456685453738766, -0.716468331278313, 0.0191464069565322, -0.195673966587587, 0.992242347416498, 0.614057916757745, -1.05709646374911, 0.696909490275077, 0.512463253128406, 0.662001920396298, 0.872565740327493, -1.11459614538561, 1.69024772549352, 0.665667824594819, 2.05780148393012, 0.27563147639584, 0.502378184602246, 1.70311679885905, -0.112242825852828, 0.472951008632787, 2.57029464084842, -0.374900537326513, 0.579522092732981, -1.1190703942347, -0.0296217792074849, 0.926962346860695, -0.132791198418488, 1.33462800417935, -0.412806270447613, -0.227234683524909, 0.359987619843063, -0.154919601426169, 0.189354615750427, 1.41882513592168, 1.68384262792807, 0.014373556665571, 0.53004604358111, -0.397265653944783, 1.34791126290983, -0.492236336299284, -0.543996434859638, 0.687755818257229, 0.563219229034295, -1.26439939292419, -0.131023089780386, -0.907742938920949, 1.65162487182489, -0.748754901021104, -0.609888878525537, 1.13713668497213, -0.0311542401318915, 1.84546662099946, 0.634675733342574, -0.0316544588463821, 1.97563700394947, -0.167833564108262, -0.747966085075956, 2.15161003522964, 1.65885987513791, -0.907706879259157, -0.124014321909472, 1.64034734155308, 2.53878064194249, 0.206394868028345, -0.558102070650145, 0.645179575253482, -0.204160893968039, 0.608635719935998, 0.964176226238702, 1.22827611606844, 0.102678247847943, -0.926314741327882, 0.046072101076812, -0.159729327586727, 1.92937209243695, 1.16859269838081, 2.5501138108761, -1.22043172084056, -0.0461706428173189, -0.192212385806232, -0.181695015357923, 0.277254668919084, -1.13992943202666, 0.447761305899696, 1.74169355429031, 0.593967013781771, -0.879666735939963, 0.676792155566619, 0.27975291557113, 1.92182718475104, 0.162444047612105, 0.638457674250972, -1.4370784423043, -0.126933074239229, -0.843768586085349, 1.80668703233716, 1.57981542625945, 2.40419958834998, 0.549299570701246, 0.802835774197584]

@prior
@limits <lower=0,upper=1>
float robust_weight[N]
int N
matrix [size(x),size(x)] K
float neg_half
float sq_alpha
N = size(x)
neg_half = -0.5
sq_alpha = square(alpha)
for(i in 1:(size(x)-1)){
K[i,i] = sq_alpha+delta
for(j in (i+1):N){
K[i,j] = sq_alpha*exp(neg_half*dot_self((x[i]-x[j])))
K[j,i] = K[i,j]
}
}
K[size(x),size(x)] = sq_alpha+delta
@blk start transformeddata
float delta
@blk end transformeddata
delta = 0.000000001
@limits <lower=0>
@prior
vector [D] rho
@limits <lower=0>
@prior
float alpha
@limits <lower=0>
@prior
float sigma
@prior
vector [N] eta
vector [N] f
matrix [N,N] L_K
L_K = L_cov_exp_quad_ARD(x,alpha,rho,delta)
f = L_K*eta
rho = inv_gamma(5,5)
alpha = normal(0,1)
sigma = normal(0,1)
eta = normal(0,1)
for(observe_i in 1:N){
target = target + normal_lpdf(y[observe_i],f[observe_i],sigma)*robust_weight[observe_i]
}

